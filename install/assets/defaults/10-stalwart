#!/command/with-contenv bash

CONFIG_FILE=${CONFIG_FILE:-"config.toml"}
CONFIG_PATH=${CONFIG_PATH:-"/config/"}
DATA_PATH=${DATA_PATH:-"/data/"}
LOG_FILE=${LOG_FILE:-"log.log"}
LOG_LEVEL=${LOG_LEVEL:-"INFO"}
LOG_TYPE=${LOG_TYPE:-"FILE"}
LOG_PATH=${LOG_PATH:-"/logs/"}
MODE=${MODE:-"SMTP"}
SETUP_TYPE=${SETUP_TYPE:-"AUTO"}

ENABLE_SIEVE=${ENABLE_SIEVE:-"FALSE"}
ENABLE_TLS=${ENABLE_TLS:-"TRUE"}

SERVER_NAME=${SERVER_NAME:-"${CONTAINER_NAME}"}
SERVER_SOCKET_NODELAY=${SERVER_SOCKET_NODELAY:-"TRUE"}
SERVER_SOCKET_REUSE_ADDR=${SERVER_SOCKET_REUSE_ADDR:-"TRUE"}
SERVER_SOCKET_BACKLOG=${SERVER_SOCKET_BACKLOG:-"1024"}
GLOBAL_SHARED_MAP=${GLOBAL_SHARED_MAP:-"{shard = 32, capacity = 10}"}

TLS_DEFAULT_CERT_FILE=${TLS_DEFAULT_CERT_FILE:-"/certs/stalwart.crt"} ## TODO
TLS_DEFAULT_KEY_FILE=${TLS_DEFAULT_KEY_FILE:-"/certs/stalwart.key"}
RELOAD_ON_CERT_CHANGE=${RELOAD_ON_CERT_CHANGE:-"TRUE"} ## TODO

SERVER_USER=${SERVER_USER:-"stalwart"}
SERVER_GROUP=${SERVER_GROUP:-"stalwart"}

REPORTS_PATH=${REPORTS_PATH:-"${DATA_PATH}/reports"}
REPORTS_HASH=${REPORTS_HASH:-"64"}

SMTP_SESSION_TIMEOUT=${SMTP_SESSION_TIMEOUT:-"5m"}
SMTP_SESSION_TRANSFER_LIMIT=${SMTP_SESSION_TRANSFER_LIMIT:-"2621440000"}
SMTP_SESSION_DURATION=${SMTP_SESSION_DURATION:-"10m"}

SMTP_SESSION_EHLO_REQUIRE=${SMTP_SESSION_EHLO_REQUIRE:-"TRUE"}
SMTP_SESSION_EHLO_REJECT_NON_FQDN=${SMTP_SESSION_EHLO_REJECT_NON_FQDN:-'{ if = "listener", eq = "smtp", then = true} { else = false }'}

SMTP_SESSION_EXTENSIONS_PIPELINING=${SMTP_SESSION_EXTENSIONS_PIPELINING:-"TRUE"}
SMTP_SESSION_EXTENSIONS_CHUNKING=${SMTP_SESSION_EXTENSIONS_CHUNKING:-"TRUE"}
SMTP_SESSION_EXTENSIONS_REQUIRETLS=${SMTP_SESSION_EXTENSIONS_REQUIRETLS:-"TRUE"}
SMTP_SESSION_EXTENSIONS_NO_SOLICITING=${SMTP_SESSION_EXTENSIONS_NO_SOLICITING:-" "}
SMTP_SESSION_EXTENSIONS_DSN=${SMTP_SESSION_EXTENSIONS_DSN:-'{ if = "authenticated-as", ne = "", then = true}, { else = false }'}
SMTP_SESSION_EXTENSIONS_EXPN=${SMTP_SESSION_EXTENSIONS_EXPN:-'{ if = "authenticated-as", ne = "", then = true}, { else = false }'}
SMTP_SESSION_EXTENSIONS_VRFY=${SMTP_SESSION_EXTENSIONS_VRFY:-'{ if = "authenticated-as", ne = "", then = true}, { else = false }'}
SMTP_SESSION_EXTENSIONS_FUTURE_RELEASE=${SMTP_SESSION_EXTENSIONS_FUTURE_RELEASE:-'{ if = "authenticated-as", ne = "", then = "7d"}, { else = false }'}
SMTP_SESSION_EXTENSIONS_DELIVER_BY=${SMTP_SESSION_EXTENSIONS_DELIVER_BY:-'{ if = "authenticated-as", ne = "", then = "15d"}, { else = false }'}
SMTP_SESSION_EXTENSIONS_MT_PRIORITY=${SMTP_SESSION_EXTENSIONS_MT_PRIORITY:-'{ if = "authenticated-as", ne = "", then = "mixer"}, { else = false }'}

SMTP_SESSION_AUTH_MECHANISMS=${SMTP_SESSION_AUTH_MECHANISMS:-'{ if = "listener", ne = "smtp", then = ["plain", "login"]}, { else = [] }'}
SMTP_SESSION_AUTH_DIRECTORY=${SMTP_SESSION_AUTH_DIRECTORY:-'{ if = "listener", ne = "smtp", then = "default" }, { else = false }'}
SMTP_SESSION_AUTH_REQUIRE=${SMTP_SESSION_AUTH_REQUIRE:-'{ if = "listener", ne = "smtp", then = true}, { else = false }'}
SMTP_SESSION_AUTH_ALLOW_PLAIN_TEXT=${SMTP_SESSION_AUTH_ALLOW_PLAIN_TEXT:-"FALSE"}
SMTP_SESSION_AUTH_ERRORS=${SMTP_SESSION_AUTH_ERRORS:-""}

SMTP_SESSION_AUTH_ERRORS_TOTAL=${SMTP_SESSION_AUTH_ERRORS_TOTAL:-"3"}
SMTP_SESSION_AUTH_ERRORS_WAIT=${SMTP_SESSION_AUTH_ERRORS_WAIT:-"5s"}

SMTP_REMOTE_LOCAL_ADDRESS=${SMTP_REMOTE_LOCAL_ADDRESS:-"127.0.0.1"}
SMTP_REMOTE_LOCAL_PORT=${SMTP_REMOTE_LOCAL_PORT:-"11200"}
SMTP_REMOTE_LOCAL_PROTOCOL=${SMTP_REMOTE_LOCAL_PROTOCOL:-"lmtp"}
SMTP_REMOTE_LOCAL_CONCURRENCY=${SMTP_REMOTE_LOCAL_CONCURRENCY:-"10"}
SMTP_REMOTE_LOCAL_TIMEOUT=${SMTP_REMOTE_LOCAL_TIMEOUT:-"1m"}

SMTP_REMOTE_LOCAL_TLS_IMPLICIT=${SMTP_REMOTE_LOCAL_TLS_IMPLICIT:-"FALSE"}
SMTP_REMOTE_LOCAL_TLS_ALLOW_INVALID_CERTS=${SMTP_REMOTE_LOCAL_TLS_ALLOW_INVALID_CERTS:-"TRUE"}

SMTP_REMOTE_LOCAL_AUTH_USERNAME=${SMTP_REMOTE_LOCAL_AUTH_USERNAME=""}
SMTP_REMOTE_LOCAL_AUTH_SECRET=${SMTP_REMOTE_LOCAL_AUTH_SECRET=""}

SMTP_SESSSION_RCPT_SCRIPT=${SMTP_SESSION_RCPT_SCRIPT:-""}
SMTP_SESSSION_RCPT_RELAY=${SMTP_SESSION_RCPT_RELAY:-"{ if = "authenticated-as", ne = "", then = true }, { else = false }"}
SMTP_SESSSION_RCPT_REWRITE=${SMTP_SESSION_RCPT_REWRITE:-""}
SMTP_SESSSION_RCPT_MAX_RECIPIENTS=${SMTP_SESSION_RCPT_MAX_RECIPIENTS:-"25"}
SMTP_SESSSION_RCPT_DIRECTORY=${SMTP_SESSION_RCPT_DIRECTORY:-"default"}

SMTP_SESSSION_RCPT_ERRORS_TOTAL=${SMTP_SESSION_RCPT_ERRORS_TOTAL:-"5"}
SMTP_SESSSION_RCPT_ERRORS_WAIT=${SMTP_SESSION_RCPT_ERRORS_WAIT:-"5s"}

SMTP_SESSSION_DATA_SCRIPT=${SMTP_SESSION_DATA_SCRIPT:-"{ if = "authenticated-as", eq = "", then = "spam-filter"}, { else = "track-replies" }"}

SMTP_SESSSION_DATA_LIMITS_MESSAGES=${SMTP_SESSION_DATA_LIMITS_MESSAGES:-"10"}
SMTP_SESSSION_DATA_LIMITS_SIZE=${SMTP_SESSION_DATA_LIMITS_SIZE:-"104857600"}
SMTP_SESSSION_DATA_LIMITS_RECEIVED_HEADERS=${SMTP_SESSION_DATA_LIMITS_RECEIVED_HEADERS:-"50"}

SMTP_SESSSION_THROTTLE_=${SMTP_SESSION_THROTTLE_:-""} ## TODO Need to support multiple blocks
SMTP_SESSSION_THROTTLE_=${SMTP_SESSION_THROTTLE_:-""} ## TODO Need to support multiple blocks
SMTP_SESSSION_THROTTLE_=${SMTP_SESSION_THROTTLE_:-""} ## TODO Need to support multiple blocks
SMTP_SESSSION_THROTTLE_=${SMTP_SESSION_THROTTLE_:-""} ## TODO Need to support multiple blocks
SMTP_SESSSION_THROTTLE_=${SMTP_SESSION_THROTTLE_:-""} ## TODO Need to support multiple blocks
SMTP_SESSSION_THROTTLE_=${SMTP_SESSION_THROTTLE_:-""} ## TODO Need to support multiple blocks
SMTP_SESSSION_THROTTLE_=${SMTP_SESSION_THROTTLE_:-""} ## TODO Need to support multiple blocks

SMTP_RESOLVER_TYPE=${SMTP_RESOLVER_TYPE:-"system"}
SMTP_RESOLVER_PRESERVE_INTERMEDIATES=${SMTP_RESOLVER_PRESERVE_INTERMEDIATES:-"FALSE"}
SMTP_RESOLVER_CONCURRENCY=${SMTP_RESOLVER_CONCURRENCY:-"2"}
SMTP_RESOLVER_TIMEOUT=${SMTP_RESOLVER_TIMEOUT:-"5s"}
SMTP_RESOLVER_ATTEMPTS=${SMTP_RESOLVER_ATTEMPTS:-"2"}
SMTP_RESOLVER_TRY_TCP_ON_ERROR=${SMTP_RESOLVER_TRY_TCP_ON_ERROR:-"TRUE"}
SMTP_RESOLVER_PUBLIC_SUFFIX=${SMTP_RESOLVER_PUBLIC_SUFFIX:-"'https://publicsuffix.org/list/public_suffix_list.dat', 'file://${CONFIG_PATH}/spamfilter/maps/suffix_list.dat.gz'"} ## TODO This path is bad and also should be a proper CSV

SMTP_RESOLVER_CACHE_TXT=${SMTP_RESOLVER_CACHE_TXT:-"2048"}
SMTP_RESOLVER_CACHE_MX=${SMTP_RESOLVER_CACHE_MX:-"1024"}
SMTP_RESOLVER_CACHE_IPV4=${SMTP_RESOLVER_CACHE_IPV4:-"1024"}
SMTP_RESOLVER_CACHE_IPV6=${SMTP_RESOLVER_CACHE_IPV6:-"1024"}
SMTP_RESOLVER_CACHE_PTR=${SMTP_RESOLVER_CACHE_PTR:-"1024"}
SMTP_RESOLVER_CACHE_TLSA=${SMTP_RESOLVER_CACHE_TLSA:-"1024"}
SMTP_RESOLVER_CACHE_MTA_STS=${SMTP_RESOLVER_CACHE_MTA_STS:-"1024"}

SMTP_AUTH_IPREV_VERIFY=${SMTP_AUTH_IPREV_VERIFY:-'{ if = "listener", eq = "smtp", then = "relaxed" }, { else = "disable" }'}
SMTP_AUTH_DKIM_VERIFY=${SMTP_AUTH_DKIM_VERIFY:-"relaxed"}
SMTP_AUTH_DKIM_SIGN=${SMTP_AUTH_DKIM_SIGN:-'{ if = "listener", ne = "smtp", then = ["rsa"] }, { else = [] }'}
SMTP_AUTH_SPF_VERIFY_EHLO=${SMTP_AUTH_SPF_VERIFY_EHLO:-'{ if = "listener", eq = "smtp", then = "relaxed" }, { else = "disable" }'}
SMTP_AUTH_SPF_VERIFY_MAIL_FROM=${SMTP_AUTH_SPF_VERIFY_MAIL_FROM:-'{ if = "listener", eq = "smtp", then = "relaxed" }, { else = "disable" }'}
SMTP_AUTH_ARC_VERIFY=${SMTP_AUTH_ARC_VERIFY:-"relaxed"}
SMTP_AUTH_ARC_SEAL=${SMTP_AUTH_ARC_SEAL:-"'rsa'"}

SMTP_AUTH_DMARC_VERIFY=${SMTP_AUTH_DMARC_VERIFY:-'{ if = "listener", eq = "smtp", then = "relaxed" }, { else = "disable" }'}

DIRECTORY_DEFAULT_LDAP_TYPE=${DIRECTORY_DEFAULT_LDAP_TYPE:-"ldap"}
DIRECTORY_DEFAULT_LDAP_ADDRESS=${DIRECTORY_DEFAULT_LDAP_ADDRESS:-"ldap://ldap:389"}
DIRECTORY_DEFAULT_LDAP_BASE_DN=${DIRECTORY_DEFAULT_LDAP_BASE_DN:-"dc=example,dc=org"}

DIRECTORY_DEFAULT_LDAP_BIND_DN=${DIRECTORY_DEFAULT_LDAP_BIND_DN:-"cn=serviceuser,ou=svcaccts,dc=example,dc=org"}
DIRECTORY_DEFAULT_LDAP_BIND_SECRET=${DIRECTORY_DEFAULT_LDAP_BIND_SECRET:-"mysecret"}

DIRECTORY_DEFAULT_LDAP_CACHE_ENTRIES=${DIRECTORY_DEFAULT_LDAP_CACHE_ENTRIES:-"500"}
DIRECTORY_DEFAULT_LDAP_CACHE_TTL=${DIRECTORY_DEFAULT_LDAP_CACHE_TTL:-"{positive = '1h', negative = '10m'}"}

DIRECTORY_DEFAULT_LDAP_OPTIONS_CATCH_ALL=${DIRECTORY_DEFAULT_LDAP_OPTIONS_CATCH_ALL:-"TRUE"}
DIRECTORY_DEFAULT_LDAP_OPTIONS_SUBADDRESSING=${DIRECTORY_DEFAULT_LDAP_OPTIONS_SUBADDRESSING:-"TRUE"}
DIRECTORY_DEFAULT_LDAP_OPTIONS_SUPERUSER_GROUP=${DIRECTORY_DEFAULT_LDAP_OPTIONS_SUPERUSER_GROUP:-"superusers"}

DIRECTORY_DEFAULT_LDAP_POOL_MAX_CONNECTIONS=${DIRECTORY_DEFAULT_LDAP_POOL_MAX_CONNECTIONS:-"10"}
DIRECTORY_DEFAULT_LDAP_POOL_MIN_CONNECTIONS=${DIRECTORY_DEFAULT_LDAP_POOL_MIN_CONNECTIONS:-"0"}
DIRECTORY_DEFAULT_LDAP_POOL_MAX_LIFETIME=${DIRECTORY_DEFAULT_LDAP_POOL_MAX_LIFETIME:-"30m"}
DIRECTORY_DEFAULT_LDAP_POOL_IDLE_TIMEOUT=${DIRECTORY_DEFAULT_LDAP_POOL_IDLE_TIMEOUT:-"10m"}
DIRECTORY_DEFAULT_LDAP_POOL_CONNECT_TIMEOUT=${DIRECTORY_DEFAULT_LDAP_POOL_CONNECT_TIMEOUT:-"30s"}

DIRECTORY_DEFAULT_LDAP_FILTER_NAME=${DIRECTORY_DEFAULT_LDAP_FILTER_NAME:-"(&(|(objectClass=posixAccount)(objectClass=posixGroup))(uid=?))"}
DIRECTORY_DEFAULT_LDAP_FILTER_EMAIL=${DIRECTORY_DEFAULT_LDAP_FILTER_EMAIL:-"(&(|(objectClass=posixAccount)(objectClass=posixGroup))(|(mail=?)(mailAlias=?)(mailList=?)))"}
DIRECTORY_DEFAULT_LDAP_FILTER_VERIFY=${DIRECTORY_DEFAULT_LDAP_FILTER_VERIFY:-"(&(|(objectClass=posixAccount)(objectClass=posixGroup))(|(mail=*?*)(mailAlias=*?*)))"}
DIRECTORY_DEFAULT_LDAP_FILTER_EXPAND=${DIRECTORY_DEFAULT_LDAP_FILTER_EXPAND:-"(&(|(objectClass=posixAccount)(objectClass=posixGroup))(mailList=?))"}
DIRECTORY_DEFAULT_LDAP_FILTER_DOMAINS=${DIRECTORY_DEFAULT_LDAP_FILTER_DOMAINS:-"(&(|(objectClass=posixAccount)(objectClass=posixGroup))(|(mail=*@?)(mailAlias=*@?)))"}

DIRECTORY_DEFAULT_LDAP_OBJECT_CLASSES_USER=${DIRECTORY_DEFAULT_LDAP_OBJECT_CLASSES_USER:-"posixAccount"}
DIRECTORY_DEFAULT_LDAP_OBJECT_CLASSES_GROUP=${DIRECTORY_DEFAULT_LDAP_OBJECT_CLASSES_GROUP:-"posixGroup"}

DIRECTORY_DEFAULT_LDAP_ATTRIBUTES_NAME=${DIRECTORY_DEFAULT_LDAP_ATTRIBUTES_NAME:-"uid"}
DIRECTORY_DEFAULT_LDAP_ATTRIBUTES_DESCRIPTION=${DIRECTORY_DEFAULT_LDAP_ATTRIBUTES_DESCRIPTION:-'"principalName", "description"'}
DIRECTORY_DEFAULT_LDAP_ATTRIBUTES_SECRET=${DIRECTORY_DEFAULT_LDAP_ATTRIBUTES_SECRET:-"userPassword"}
DIRECTORY_DEFAULT_LDAP_ATTRIBUTES_GROUPS=${DIRECTORY_DEFAULT_LDAP_ATTRIBUTES_GROUPS:-'"memberOf", "otherGroups"'}
DIRECTORY_DEFAULT_LDAP_ATTRIBUTES_EMAIL=${DIRECTORY_DEFAULT_LDAP_ATTRIBUTES_EMAIL:-"mail"}
DIRECTORY_DEFAULT_LDAP_ATTRIBUTES_EMAIL_ALIAS=${DIRECTORY_DEFAULT_LDAP_ATTRIBUTES_EMAIL_ALIAS:-"mailAlias"}
DIRECTORY_DEFAULT_LDAP_ATTRIBUTES_QUOTA=${DIRECTORY_DEFAULT_LDAP_ATTRIBUTES_QUOTA:-"diskQuota"}

SMTP_LISTENER_SMTP_BIND=${SMTP_LISTENER_SMTP_BIND:-"'[::]:25'"}
SMTP_LISTENER_SMTP_GREETING=${SMTP_LISTENER_SMTP_GREETING:-"Stalwart SMTP at your service"}
SMTP_LISTENER_SMTP_PROTOCOL=${SMTP_LISTENER_SMTP_PROTOCOL:-"smtp"}

SMTP_LISTENER_SUBMISSION_BIND=${SMTP_LISTENER_SUBMISSION_BIND:-"'[::]:465'"}
SMTP_LISTENER_SUBMISSION_GREETING=${SMTP_LISTENER_SUBMISSION_GREETING:-"Stalwart SMTP at your service"}
SMTP_LISTENER_SUBMISSION_PROTOCOL=${SMTP_LISTENER_SUBMISSION_PROTOCOL:-"smtp"}

SMTP_LISTENER_SUBMISSIONS_BIND=${SMTP_LISTENER_SUBMISSIONS_BIND:-"'[::]:587'"}
SMTP_LISTENER_SUBMISSIONS_GREETING=${SMTP_LISTENER_SUBMISSIONS_GREETING:-"Stalwart SMTP at your service"}
SMTP_LISTENER_SUBMISSIONS_PROTOCOL=${SMTP_LISTENER_SUBMISSIONS_PROTOCOL:-"smtp"}
SMTP_LISTENER_SUBMISSIONS_TLS_IMPLICIT=${SMTP_LISTENER_SUBMISSIONS_TLS_IMPLICIT:-"TRUE"}

SMTP_LISTENER_MANAGEMENT_BIND=${SMTP_LISTENER_MANAGEMENT_BIND:-"'127.0.0.1:8000"}
SMTP_LISTENER_MANAGEMENT_PROTOCOL=${SMTP_LISTENER_MANAGEMENT_PROTOCOL:-"http"}

SMTP_MANAGEMENT_DIRECTORY=${SMTP_MANAGEMENT_DIRECTORY:-"default"}
SMTP_SESSION_DATA_MILTER_RSPAMD_ENABLE=${SMTP_SESSION_DATA_MILTER_RSPAMD_ENABLE:-"{ if = "listener", eq = "smtp", then = true }, { else = false }"}
SMTP_SESSION_DATA_MILTER_RSPAMD_HOSTNAME=${SMTP_SESSION_DATA_MILTER_RSPAMD_HOSTNAME:-"127.0.0.1"}
SMTP_SESSION_DATA_MILTER_RSPAMD_PORT=${SMTP_SESSION_DATA_MILTER_RSPAMD_PORT:-"11332"}
SMTP_SESSION_DATA_MILTER_RSPAMD_TLS=${SMTP_SESSION_DATA_MILTER_RSPAMD_TLS:-"FALSE"}
SMTP_SESSION_DATA_MILTER_RSPAMD_ALLOW_INVALID_CERTS=${SMTP_SESSION_DATA_MILTER_RSPAMD_ALLOW_INVALID_CERTS:-"FALSE"}

SMTP_SESSION_DATA_MILTER_RSPAMD_TIMEOUT_CONNECT=${SMTP_SESSION_DATA_MILTER_RSPAMD_TIMEOUT_CONNECT:-"30s"}
SMTP_SESSION_DATA_MILTER_RSPAMD_TIMEOUT_COMMAND=${SMTP_SESSION_DATA_MILTER_RSPAMD_TIMEOUT_COMMAND:-"30s"}
SMTP_SESSION_DATA_MILTER_RSPAMD_TIMEOUT_DATA=${SMTP_SESSION_DATA_MILTER_RSPAMD_TIMEOUT_DATA:-"60s"}

SMTP_SESSION_DATA_MILTER_RSPAMD_OPTIONS_TEMPFAIL_ON_ERROR=${SMTP_SESSION_DATA_MILTER_RSPAMD_OPTIONS_TEMPFAIL_ON_ERROR:-"TRUE"}
SMTP_SESSION_DATA_MILTER_RSPAMD_OPTIONS_MAX_RESPONSE_SIZE=${SMTP_SESSION_DATA_MILTER_RSPAMD_OPTIONS_MAX_RESPONSE_SIZE:-"52428800"}
SMTP_SESSION_DATA_MILTER_RSPAMD_OPTIONS_VERSION=${SMTP_SESSION_DATA_MILTER_RSPAMD_OPTIONS_VERSION:-"6"}

SMTP_SESSION_DATA_PIPE_SPAM_ASSASSIN_COMMAND=${SMTP_SESSION_DATA_PIPE_SPAM_ASSASSIN_COMMAND:-"spamc"}
SMTP_SESSION_DATA_PIPE_SPAM_ASSASSIN_ARGUMENTS=${SMTP_SESSION_DATA_PIPE_SPAM_ASSASSIN_ARGUMENTS:-""}
SMTP_SESSION_DATA_PIPE_SPAM_ASSASSIN_TIMEOUT=${SMTP_SESSION_DATA_PIPE_SPAM_ASSASSIN_TIMEOUT:-"10s"}

SMTP_SIGNATURE_RSA_PRIVATE_KEY=${SMTP_SIGNATURE_RSA_PRIVATE_KEY:-""} ## TODO prefixed with file://
SMTP_SIGNATURE_RSA_PUBLIC_KEY=${SMTP_SIGNATURE_RSA_PUBLIC_KEY:-""} ## TODO prefixed with file://
SMTP_SIGNATURE_RSA_DOMAIN=${SMTP_SIGNATURE_RSA_DOMAIN:-"${DOMAIN_NAME}"}
SMTP_SIGNATURE_RSA_SELECTOR=${SMTP_SIGNATURE_RSA_SELECTOR:-"stalwart"}
SMTP_SIGNATURE_RSA_HEADERS=${SMTP_SIGNATURE_RSA_HEADERS:-"'From', 'To', 'Subject', 'Message-ID'"}
SMTP_SIGNATURE_RSA_ALGORITHM=${SMTP_SIGNATURE_RSA_ALGORITHM:-"rsa-sha256"}
SMTP_SIGNATURE_RSA_CANONICALIZATION=${SMTP_SIGNATURE_RSA_CANONICALIZATION:-"relaxed/relaxed"}
SMTP_SIGNATURE_RSA_EXPIRE=${SMTP_SIGNATURE_RSA_EXPIRE:-""}
SMTP_SIGNATURE_RSA_THIRD_PARTY=${SMTP_SIGNATURE_RSA_THIRD_PARTY:-""}
SMTP_SIGNATURE_RSA_THIRD_PARTY_ALGO=${SMTP_SIGNATURE_RSA_THIRD_PARTY_ALGO:-""}
SMTP_SIGNATURE_RSA_AUID=${SMTP_SIGNATURE_RSA_AUID:-""}
SMTP_SIGNATURE_RSA_SET_BODY_LENGTH=${SMTP_SIGNATURE_RSA_SET_BODY_LENGTH:-"FALSE"}
SMTP_SIGNATURE_RSA_REPORT=${SMTP_SIGNATURE_RSA_REPORT:-"TRUE"}

SMTP_QUEUE_PATH=${SMTP_QUEUE_PATH:-"${DATA_PATH}/queue"} ## TODO make sure we create this folder
SMTP_QUEUE_HASH=${SMTP_QUEUE_HASH:-"64"}

SMTP_QUEUE_SCHEDULE_RETRY=${SMTP_QUEUE_SCHEDULE_RETRY:-"'2m', '5m', '10m', '15m', '30m', '1h', '2h'"}
SMTP_QUEUE_SCHEDULE_NOTIFY=${SMTP_QUEUE_SCHEDULE_NOTIFY:-"'1d', '3d'"}
SMTP_QUEUE_SCHEDULE_EXPIRE=${SMTP_QUEUE_SCHEDULE_EXPIRE:-"5d"}

SMTP_QUEUE_OUTBOUND_HOSTNAME=${SMTP_QUEUE_OUTBOUND_HOSTNAME:-""}
SMTP_QUEUE_OUTBOUND_NEXT_HOP=${SMTP_QUEUE_OUTBOUND_NEXT_HOP:-"{ if = "rcpt-domain", in-list = "default/domains", then = "local" }, { else = false }"}
SMTP_QUEUE_OUTBOUND_IP_STRATEGY=${SMTP_QUEUE_OUTBOUND_IP_STRATEGY:-"ipv4-then-ipv6"}

SMTP_QUEUE_OUTBOUND_TLS_DANE=${SMTP_QUEUE_OUTBOUND_TLS_DANE:-"OPTIONAL"}
SMTP_QUEUE_OUTBOUND_TLS_MTA_STS=${SMTP_QUEUE_OUTBOUND_TLS_MTA_STS:-"OPTIONAL"}
SMTP_QUEUE_OUTBOUND_TLS_STARTTLS=${SMTP_QUEUE_OUTBOUND_TLS_STARTTLS:-"REQUIRE"}
SMTP_QUEUE_OUTBOUND_TLS_ALLOW_INVALID_CERTS=${SMTP_QUEUE_OUTBOUND_TLS_ALLOW_INVALID_CERTS:-"FALSE"}

SMTP_QUEUE_OUTBOUND_SOURCE_IP_V4=${SMTP_QUEUE_OUTBOUND_SOURCE_IP_V4:-""}
SMTP_QUEUE_OUTBOUND_SOURCE_IP_V6=${SMTP_QUEUE_OUTBOUND_SOURCE_IP_V6:-""}

SMTP_QUEUE_OUTBOUND_LIMITS_MX=${SMTP_QUEUE_OUTBOUND_LIMITS_MX:-"7"}
SMTP_QUEUE_OUTBOUND_LIMITS_MULTIHOMED=${SMTP_QUEUE_OUTBOUND_LIMITS_MULTIHOMED:-"2"}

SMTP_QUEUE_OUTBOUND_TIMEOUTS_CONNECT=${SMTP_QUEUE_OUTBOUND_TIMEOUTS_CONNECT:-"3m"}
SMTP_QUEUE_OUTBOUND_TIMEOUTS_GREETING=${SMTP_QUEUE_OUTBOUND_TIMEOUTS_GREETING:-"3m"}
SMTP_QUEUE_OUTBOUND_TIMEOUTS_TLS=${SMTP_QUEUE_OUTBOUND_TIMEOUTS_TLS:-"2m"}
SMTP_QUEUE_OUTBOUND_TIMEOUTS_EHLO=${SMTP_QUEUE_OUTBOUND_TIMEOUTS_EHLO:-"3m"}
SMTP_QUEUE_OUTBOUND_TIMEOUTS_MAIL_FROM=${SMTP_QUEUE_OUTBOUND_TIMEOUTS_MAIL_FROM:-"3m"}
SMTP_QUEUE_OUTBOUND_TIMEOUTS_RCPT_TO=${SMTP_QUEUE_OUTBOUND_TIMEOUTS_RCPT_TO:-"3m"}
SMTP_QUEUE_OUTBOUND_TIMEOUTS_DATA=${SMTP_QUEUE_OUTBOUND_TIMEOUTS_DATA:-"10m"}
SMTP_QUEUE_OUTBOUND_TIMEOUTS_MTA_STS=${SMTP_QUEUE_OUTBOUND_TIMEOUTS_MTA_STS:-"2m"}

SMTP_QUEUE_QUOTA_MATCH=${SMTP_QUEUE_QUOTA_MATCH:-""}
SMTP_QUEUE_QUOTA_KEY=${SMTP_QUEUE_QUOTA_KEY:-""}
SMTP_QUEUE_QUOTA_MESSAGES=${SMTP_QUEUE_QUOTA_MESSAGES:-"100000"}
SMTP_QUEUE_QUOTA_SIZE=${SMTP_QUEUE_QUOTA_SIZE:-"10737418240"}

SMTP_QUEUE_THROTTLE_KEY=${SMTP_QUEUE_THROTTLE_KEY:-"'rcpt-domain'"}
SMTP_QUEUE_THROTTLE_RATE=${SMTP_QUEUE_THROTTLE_RATE:-""}
SMTP_QUEUE_THROTTLE_CONCURRENCY=${SMTP_QUEUE_THROTTLE_CONCURRENCY:-"5"}

SIEVE_UNTRUSTED_DISABLE_CAPABILITIES=${SIEVE_UNTRUSTED_DISABLE_CAPABILITIES:-""}
SIEVE_UNTRUSTED_NOTIFICATION_URIS=${SIEVE_UNTRUSTED_NOTIFICATION_URIS:-"malto"}
SIEVE_UNTRUSTED_PROTECTED_HEADERS=${SIEVE_UNTRUSTED_PROTECTED_HEADERS:-'"Original-Subject", "Original-From", "Received", "Auto-Submitted"'}

SIEVE_UNTRUSTED_LIMITS_NAME_LENGTH=${SIEVE_UNTRUSTED_LIMITS_NAME_LENGTH:-"512"}
SIEVE_UNTRUSTED_LIMITS_MAX_SCRIPTS=${SIEVE_UNTRUSTED_LIMITS_MAX_SCRIPTS:-"256"}
SIEVE_UNTRUSTED_LIMITS_SCRIPT_SIZE=${SIEVE_UNTRUSTED_LIMITS_SCRIPT_SIZE:-"102400"}
SIEVE_UNTRUSTED_LIMITS_STRING_LENGTH=${SIEVE_UNTRUSTED_LIMITS_STRING_LENGTH:-"4096"}
SIEVE_UNTRUSTED_LIMITS_VARIABLE_NAME_LENGTH=${SIEVE_UNTRUSTED_LIMITS_VARIABLE_NAME_LENGTH:-"32"}
SIEVE_UNTRUSTED_LIMITS_VARIABLE_SIZE=${SIEVE_UNTRUSTED_LIMITS_VARIABLE_SIZE:-"4096"}
SIEVE_UNTRUSTED_LIMITS_NESTED_BLOCKS=${SIEVE_UNTRUSTED_LIMITS_NESTED_BLOCKS:-"15"}
SIEVE_UNTRUSTED_LIMITS_NESTED_TESTS=${SIEVE_UNTRUSTED_LIMITS_NESTED_TESTS:-"15"}
SIEVE_UNTRUSTED_LIMITS_NESTED_FOREVERYPART=${SIEVE_UNTRUSTED_LIMITS_NESTED_FOREVERYPART:-"3"}
SIEVE_UNTRUSTED_LIMITS_MATCH_VARIABLES=${SIEVE_UNTRUSTED_LIMITS_MATCH_VARIABLES:-"30"}
SIEVE_UNTRUSTED_LIMITS_LOCAL_VARIABLES=${SIEVE_UNTRUSTED_LIMITS_LOCAL_VARIABLES:-"128"}
SIEVE_UNTRUSTED_LIMITS_HEADER_SIZE=${SIEVE_UNTRUSTED_LIMITS_HEADER_SIZE:-"1024"}
SIEVE_UNTRUSTED_LIMITS_INCLUDES=${SIEVE_UNTRUSTED_LIMITS_INCLUDES:-"3"}
SIEVE_UNTRUSTED_LIMITS_NESTED_INCLUDES=${SIEVE_UNTRUSTED_LIMITS_NESTED_INCLUDES:-"3"}
SIEVE_UNTRUSTED_LIMITS_CPU=${SIEVE_UNTRUSTED_LIMITS_CPU:-"5000"}
SIEVE_UNTRUSTED_LIMITS_REDIRECTS=${SIEVE_UNTRUSTED_LIMITS_REDIRECTS:-"1"}
SIEVE_UNTRUSTED_LIMITS_RECEIVED_HEADERS=${SIEVE_UNTRUSTED_LIMITS_RECEIVED_HEADERS:-"10"}
SIEVE_UNTRUSTED_LIMITS_OUTGOING_MESSAGES=${SIEVE_UNTRUSTED_LIMITS_OUTGOING_MESSAGES:-"3"}

SIEVE_UNTRUSTED_VACATION_DEFAULT_SUBJECT=${SIEVE_UNTRUSTED_VACATION_DEFAULT_SUBJECT:-"Automated reply"}
SIEVE_UNTRUSTED_VACATION_SUBJECT_PREFIX=${SIEVE_UNTRUSTED_VACATION_SUBJECT_PREFIX:-"Auto: "}

SIEVE_UNTRUSTED_DEFAULT_EXPIRY_VACATION=${SIEVE_UNTRUSTED_DEFAULT_EXPIRY_VACATION:-"30d"}
SIEVE_UNTRUSTED_DEFAULT_EXPIRY_DUPLICATE=${SIEVE_UNTRUSTED_DEFAULT_EXPIRY_DUPLICATE:-"7d"}

SIEVE_TRUSTED_FROM_NAME=${SIEVE_TRUSTED_FROM_NAME:-"Automated Message"}
SIEVE_TRUSTED_FROM_ADDR=${SIEVE_TRUSTED_FROM_ADDR:-"noreply@${DEFAULT_DOMAIN}"} ## TODO
SIEVE_TRUSTED_RETURN_PATH=${SIEVE_TRUSTED_RETURN_PATH:-""}
SIEVE_TRUSTED_HOSTNAME=${SIEVE_TRUSTED_HOSTNAME:-""}
SIEVE_TRUSTED_NO_CAPABILITY_CHECK=${SIEVE_TRUSTED_NO_CAPABILITY_CHECK:-"true"}
SIEVE_TRUSTED_SIGN=${SIEVE_TRUSTED_SIGN:-"'rsa'"}

SIEVE_TRUSTED_LIMITS_REDIRECTS=${SIEVE_TRUSTED_LIMITS_REDIRECTS:-"3"}
SIEVE_TRUSTED_LIMITS_OUT_MESSAGES=${SIEVE_TRUSTED_LIMITS_OUT_MESSAGES:-"5"}
SIEVE_TRUSTED_LIMITS_RECEIVED_HEADERS=${SIEVE_TRUSTED_LIMITS_RECEIVED_HEADERS:-"50"}
SIEVE_TRUSTED_LIMITS_CPU=${SIEVE_TRUSTED_LIMITS_CPU:-"1048576"}
SIEVE_TRUSTED_LIMITS_NESTED_INCLUDES=${SIEVE_TRUSTED_LIMITS_NESTED_INCLUDES:-"5"}
SIEVE_TRUSTED_LIMITS_DUPLICATE_EXPIRY=${SIEVE_TRUSTED_LIMITS_DUPLICATE_EXPIRY:-"7d"}

SIEVE_TRUSTED_SCRIPTS_CONNECT=${SIEVE_TRUSTED_SCRIPTS_CONNECT:-""} ## TODO
SIEVE_TRUSTED_SCRIPTS_EHLO=${SIEVE_TRUSTED_SCRIPTS_EHLO:-""}
SIEVE_TRUSTED_SCRIPTS_MAIL=${SIEVE_TRUSTED_SCRIPTS_MAIL:-""}

TLS_ENABLE=${TLS_ENABLE:-"TRUE"}
TLS_IMPLICIT=${TLS_IMPLICIT:-"FALSE"}
TLS_TIMEOUT=${TLS_TIMEOUT:-"1m"}
TLS_CERTIFICATE=${TLS_CERTIFICATE:-"default"}
TLS_IGNORE_CLIENT_ORDER=${TLS_IGNORE_CLIENT_ORDER:-"TRUE"}